{"ast":null,"code":"import { map, ReplaySubject, switchMap, take, tap } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nclass ShortcutsService {\n  /**\n   * Constructor\n   */\n  constructor(_httpClient) {\n    this._httpClient = _httpClient;\n    this._shortcuts = new ReplaySubject(1);\n  }\n  // -----------------------------------------------------------------------------------------------------\n  // @ Accessors\n  // -----------------------------------------------------------------------------------------------------\n  /**\n   * Getter for shortcuts\n   */\n  get shortcuts$() {\n    return this._shortcuts.asObservable();\n  }\n  // -----------------------------------------------------------------------------------------------------\n  // @ Public methods\n  // -----------------------------------------------------------------------------------------------------\n  /**\n   * Get all messages\n   */\n  getAll() {\n    return this._httpClient.get('api/common/shortcuts').pipe(tap(shortcuts => {\n      this._shortcuts.next(shortcuts);\n    }));\n  }\n  /**\n   * Create a shortcut\n   *\n   * @param shortcut\n   */\n  create(shortcut) {\n    return this.shortcuts$.pipe(take(1), switchMap(shortcuts => this._httpClient.post('api/common/shortcuts', {\n      shortcut\n    }).pipe(map(newShortcut => {\n      // Update the shortcuts with the new shortcut\n      this._shortcuts.next([...shortcuts, newShortcut]);\n      // Return the new shortcut from observable\n      return newShortcut;\n    }))));\n  }\n  /**\n   * Update the shortcut\n   *\n   * @param id\n   * @param shortcut\n   */\n  update(id, shortcut) {\n    return this.shortcuts$.pipe(take(1), switchMap(shortcuts => this._httpClient.patch('api/common/shortcuts', {\n      id,\n      shortcut\n    }).pipe(map(updatedShortcut => {\n      // Find the index of the updated shortcut\n      const index = shortcuts.findIndex(item => item.id === id);\n      // Update the shortcut\n      shortcuts[index] = updatedShortcut;\n      // Update the shortcuts\n      this._shortcuts.next(shortcuts);\n      // Return the updated shortcut\n      return updatedShortcut;\n    }))));\n  }\n  /**\n   * Delete the shortcut\n   *\n   * @param id\n   */\n  delete(id) {\n    return this.shortcuts$.pipe(take(1), switchMap(shortcuts => this._httpClient.delete('api/common/shortcuts', {\n      params: {\n        id\n      }\n    }).pipe(map(isDeleted => {\n      // Find the index of the deleted shortcut\n      const index = shortcuts.findIndex(item => item.id === id);\n      // Delete the shortcut\n      shortcuts.splice(index, 1);\n      // Update the shortcuts\n      this._shortcuts.next(shortcuts);\n      // Return the deleted status\n      return isDeleted;\n    }))));\n  }\n  static #_ = this.ɵfac = function ShortcutsService_Factory(t) {\n    return new (t || ShortcutsService)(i0.ɵɵinject(i1.HttpClient));\n  };\n  static #_2 = this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: ShortcutsService,\n    factory: ShortcutsService.ɵfac,\n    providedIn: 'root'\n  });\n}\nexport { ShortcutsService };","map":{"version":3,"names":["map","ReplaySubject","switchMap","take","tap","ShortcutsService","constructor","_httpClient","_shortcuts","shortcuts$","asObservable","getAll","get","pipe","shortcuts","next","create","shortcut","post","newShortcut","update","id","patch","updatedShortcut","index","findIndex","item","delete","params","isDeleted","splice","_","i0","ɵɵinject","i1","HttpClient","_2","factory","ɵfac","providedIn"],"sources":["C:\\Users\\jcfaz\\Downloads\\Projects\\desafio-afiliado\\front\\src\\app\\layout\\common\\shortcuts\\shortcuts.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { map, Observable, ReplaySubject, switchMap, take, tap } from 'rxjs';\r\nimport { Shortcut } from 'app/layout/common/shortcuts/shortcuts.types';\r\n\r\n@Injectable({\r\n    providedIn: 'root'\r\n})\r\nexport class ShortcutsService\r\n{\r\n    private _shortcuts: ReplaySubject<Shortcut[]> = new ReplaySubject<Shortcut[]>(1);\r\n\r\n    /**\r\n     * Constructor\r\n     */\r\n    constructor(private _httpClient: HttpClient)\r\n    {\r\n    }\r\n\r\n    // -----------------------------------------------------------------------------------------------------\r\n    // @ Accessors\r\n    // -----------------------------------------------------------------------------------------------------\r\n\r\n    /**\r\n     * Getter for shortcuts\r\n     */\r\n    get shortcuts$(): Observable<Shortcut[]>\r\n    {\r\n        return this._shortcuts.asObservable();\r\n    }\r\n\r\n    // -----------------------------------------------------------------------------------------------------\r\n    // @ Public methods\r\n    // -----------------------------------------------------------------------------------------------------\r\n\r\n    /**\r\n     * Get all messages\r\n     */\r\n    getAll(): Observable<Shortcut[]>\r\n    {\r\n        return this._httpClient.get<Shortcut[]>('api/common/shortcuts').pipe(\r\n            tap((shortcuts) => {\r\n                this._shortcuts.next(shortcuts);\r\n            })\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Create a shortcut\r\n     *\r\n     * @param shortcut\r\n     */\r\n    create(shortcut: Shortcut): Observable<Shortcut>\r\n    {\r\n        return this.shortcuts$.pipe(\r\n            take(1),\r\n            switchMap(shortcuts => this._httpClient.post<Shortcut>('api/common/shortcuts', {shortcut}).pipe(\r\n                map((newShortcut) => {\r\n\r\n                    // Update the shortcuts with the new shortcut\r\n                    this._shortcuts.next([...shortcuts, newShortcut]);\r\n\r\n                    // Return the new shortcut from observable\r\n                    return newShortcut;\r\n                })\r\n            ))\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Update the shortcut\r\n     *\r\n     * @param id\r\n     * @param shortcut\r\n     */\r\n    update(id: string, shortcut: Shortcut): Observable<Shortcut>\r\n    {\r\n        return this.shortcuts$.pipe(\r\n            take(1),\r\n            switchMap(shortcuts => this._httpClient.patch<Shortcut>('api/common/shortcuts', {\r\n                id,\r\n                shortcut\r\n            }).pipe(\r\n                map((updatedShortcut: Shortcut) => {\r\n\r\n                    // Find the index of the updated shortcut\r\n                    const index = shortcuts.findIndex(item => item.id === id);\r\n\r\n                    // Update the shortcut\r\n                    shortcuts[index] = updatedShortcut;\r\n\r\n                    // Update the shortcuts\r\n                    this._shortcuts.next(shortcuts);\r\n\r\n                    // Return the updated shortcut\r\n                    return updatedShortcut;\r\n                })\r\n            ))\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Delete the shortcut\r\n     *\r\n     * @param id\r\n     */\r\n    delete(id: string): Observable<boolean>\r\n    {\r\n        return this.shortcuts$.pipe(\r\n            take(1),\r\n            switchMap(shortcuts => this._httpClient.delete<boolean>('api/common/shortcuts', {params: {id}}).pipe(\r\n                map((isDeleted: boolean) => {\r\n\r\n                    // Find the index of the deleted shortcut\r\n                    const index = shortcuts.findIndex(item => item.id === id);\r\n\r\n                    // Delete the shortcut\r\n                    shortcuts.splice(index, 1);\r\n\r\n                    // Update the shortcuts\r\n                    this._shortcuts.next(shortcuts);\r\n\r\n                    // Return the deleted status\r\n                    return isDeleted;\r\n                })\r\n            ))\r\n        );\r\n    }\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}